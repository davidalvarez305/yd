{% extends 'crm/base.html' %}
{% load static %}
{% load humanize %}

{% block content %}
<form method="get" class="flex flex-wrap items-end gap-4 mb-8">
  <div class="flex gap-2">
    {{ filter_form.render }}
  </div>

  <div>
    <button
      type="submit"
      class="inline-flex items-center justify-center gap-2 rounded-lg border border-primary-700 bg-primary-700 px-3 py-2 text-sm font-semibold text-white hover:border-primary-600 hover:bg-primary-600 focus:ring focus:ring-primary-400/50 active:border-primary-700 active:bg-primary-700 dark:focus:ring-primary-400/90"
    >
      Filter
    </button>
  </div>
</form>

<div class="space-y-6">

  <!-- PLATFORM PERFORMANCE TABLE -->
  <div class="min-w-full overflow-x-auto rounded border border-gray-200 bg-white dark:border-gray-700 dark:bg-gray-800">
    <table class="min-w-full whitespace-nowrap align-middle text-sm">
      <thead>
        <tr>
          <th class="bg-gray-100/75 px-3 py-4 text-center font-semibold dark:bg-gray-700/25">
            Platform
          </th>
          <th class="bg-gray-100/75 px-3 py-4 text-center font-semibold dark:bg-gray-700/25">
            Spend
          </th>
          <th class="bg-gray-100/75 px-3 py-4 text-center font-semibold dark:bg-gray-700/25">
            Leads
          </th>
          <th class="bg-gray-100/75 px-3 py-4 text-center font-semibold dark:bg-gray-700/25">
            Events
          </th>
          <th class="bg-gray-100/75 px-3 py-4 text-center font-semibold dark:bg-gray-700/25">
            Revenue
          </th>
          <th class="bg-gray-100/75 px-3 py-4 text-center font-semibold dark:bg-gray-700/25">
            CPL
          </th>
          <th class="bg-gray-100/75 px-3 py-4 text-center font-semibold dark:bg-gray-700/25">
            CPA
          </th>
          <th class="bg-gray-100/75 px-3 py-4 text-center font-semibold dark:bg-gray-700/25">
            AOV
          </th>
          <th class="bg-gray-100/75 px-3 py-4 text-center font-semibold dark:bg-gray-700/25">
            ROAS
          </th>
          <th class="bg-gray-100/75 px-3 py-4 text-center font-semibold dark:bg-gray-700/25">
            Closing %
          </th>
        </tr>
      </thead>
      <tbody>
        <!-- Google -->
        <tr class="hover:bg-gray-50 dark:hover:bg-gray-900/50">
          <td class="p-3 text-center font-medium">Google</td>
          <td class="p-3 text-center">${{ google_ad_spend|floatformat:2|intcomma }}</td>
          <td class="p-3 text-center">{{ google_count }}</td>
          <td class="p-3 text-center">{{ google_event_count }}</td>
          <td class="p-3 text-center">${{ google_revenue|floatformat:2|intcomma }}</td>
          <td class="p-3 text-center">${{ google_cpl|floatformat:2|intcomma }}</td>
          <td class="p-3 text-center">${{ google_cpa|floatformat:2|intcomma }}</td>
          <td class="p-3 text-center">${{ google_aov|floatformat:2|intcomma }}</td>
          <td class="p-3 text-center">${{ google_roas|floatformat:2 }}</td>
          <td class="p-3 text-center">{{ google_closing_percent|floatformat:2 }}%</td>
        </tr>

        <!-- Facebook -->
        <tr class="hover:bg-gray-50 dark:hover:bg-gray-900/50">
          <td class="p-3 text-center font-medium">Facebook</td>
          <td class="p-3 text-center">${{ facebook_ad_spend|floatformat:2|intcomma }}</td>
          <td class="p-3 text-center">{{ facebook_count }}</td>
          <td class="p-3 text-center">{{ facebook_event_count }}</td>
          <td class="p-3 text-center">${{ facebook_revenue|floatformat:2|intcomma }}</td>
          <td class="p-3 text-center">${{ facebook_cpl|floatformat:2|intcomma }}</td>
          <td class="p-3 text-center">${{ facebook_cpa|floatformat:2|intcomma }}</td>
          <td class="p-3 text-center">${{ facebook_aov|floatformat:2|intcomma }}</td>
          <td class="p-3 text-center">${{ facebook_roas|floatformat:2 }}</td>
          <td class="p-3 text-center">{{ facebook_closing_percent|floatformat:2 }}%</td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- BUSINESS SEGMENT TABLE -->
  <div class="min-w-full overflow-x-auto rounded border border-gray-200 bg-white dark:border-gray-700 dark:bg-gray-800">
    <table class="min-w-full whitespace-nowrap align-middle text-sm">
      <thead>
        <tr>
          <th class="bg-gray-100/75 px-3 py-4 text-left font-semibold dark:bg-gray-700/25">
            Segment
          </th>
          <th class="bg-gray-100/75 px-3 py-4 text-center font-semibold dark:bg-gray-700/25">
            Events
          </th>
          <th class="bg-gray-100/75 px-3 py-4 text-center font-semibold dark:bg-gray-700/25">
            Total Revenue
          </th>
          <th class="bg-gray-100/75 px-3 py-4 text-center font-semibold dark:bg-gray-700/25">
            Avg Event Value
          </th>
        </tr>
      </thead>
      <tbody>
        <tr class="hover:bg-gray-50 dark:hover:bg-gray-900/50">
          <td class="p-3 font-medium">Bartending</td>
          <td class="p-3 text-center">{{ bartending_event_count }}</td>
          <td class="p-3 text-center">${{ bartending_revenue|floatformat:2|intcomma }}</td>
          <td class="p-3 text-center">${{ bartending_aov|floatformat:2|intcomma }}</td>
        </tr>

        <tr class="hover:bg-gray-50 dark:hover:bg-gray-900/50">
          <td class="p-3 font-medium">Rentals</td>
          <td class="p-3 text-center">{{ rental_event_count }}</td>
          <td class="p-3 text-center">${{ rental_revenue|floatformat:2|intcomma }}</td>
          <td class="p-3 text-center">${{ rental_aov|floatformat:2|intcomma }}</td>
        </tr>
      </tbody>
    </table>
  </div>

</div>
{% endblock %}