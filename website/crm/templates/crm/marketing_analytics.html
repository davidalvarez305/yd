{% extends 'crm/base.html' %}
{% load static %}
{% load humanize %}

{% block content %}
<form method="get" class="flex flex-wrap items-end gap-4 mb-6">
  <div class="flex gap-2">
    {{ filter_form.render }}
  </div>

  <div>
    <button type="submit" class="inline-flex items-center justify-center gap-2 rounded-lg border border-primary-700 bg-primary-700 px-3 py-2 text-sm leading-5 font-semibold text-white hover:border-primary-600 hover:bg-primary-600 hover:text-white focus:ring focus:ring-primary-400/50 active:border-primary-700 active:bg-primary-700 dark:focus:ring-primary-400/90">
      Filter
    </button>
  </div>
</form>
<div class="min-w-full overflow-x-auto rounded border border-gray-200 bg-white dark:border-gray-700 dark:bg-gray-800">
    <table class="min-w-full whitespace-nowrap align-middle text-sm">
        <thead>
            <tr>
                <th class="bg-gray-100/75 px-3 py-4 text-center font-semibold text-gray-900 dark:bg-gray-700/25 dark:text-gray-50">
                    Platform
                </th>
                <th class="bg-gray-100/75 px-3 py-4 text-center font-semibold text-gray-900 dark:bg-gray-700/25 dark:text-gray-50">
                    Spend
                </th>
                <th class="bg-gray-100/75 px-3 py-4 text-center font-semibold text-gray-900 dark:bg-gray-700/25 dark:text-gray-50">
                    Leads
                </th>
                <th class="bg-gray-100/75 px-3 py-4 text-center font-semibold text-gray-900 dark:bg-gray-700/25 dark:text-gray-50">
                    Events
                </th>
                <th class="bg-gray-100/75 px-3 py-4 text-center font-semibold text-gray-900 dark:bg-gray-700/25 dark:text-gray-50">
                    Revenue
                </th>
                <th class="bg-gray-100/75 px-3 py-4 text-center font-semibold text-gray-900 dark:bg-gray-700/25 dark:text-gray-50">
                    CPL
                </th>
                <th class="bg-gray-100/75 px-3 py-4 text-center font-semibold text-gray-900 dark:bg-gray-700/25 dark:text-gray-50">
                    CPA
                </th>
                <th class="bg-gray-100/75 px-3 py-4 text-center font-semibold text-gray-900 dark:bg-gray-700/25 dark:text-gray-50">
                    AOV
                </th>
                <th class="bg-gray-100/75 px-3 py-4 text-center font-semibold text-gray-900 dark:bg-gray-700/25 dark:text-gray-50">
                    ROAS
                </th>
                <th class="bg-gray-100/75 px-3 py-4 text-center font-semibold text-gray-900 dark:bg-gray-700/25 dark:text-gray-50">
                    Closing %
                </th>
            </tr>
        </thead>
        <tbody>
            <!-- Google Row -->
            <tr class="hover:bg-gray-50 dark:hover:bg-gray-900/50">
                <td class="p-3 text-center">
                    <p class="font-medium">Google</p>
                </td>
                <td class="p-3 text-center">
                    <p class="font-medium">${{ google_ad_spend|default:0|floatformat:2|intcomma }}</p>
                </td>
                <td class="p-3 text-center">
                    <p class="font-medium">{{ google_count }}</p>
                </td>
                <td class="p-3 text-center">
                    <p class="font-medium">{{ google_event_count }}</p>
                </td>
                <td class="p-3 text-center">
                    <p class="font-medium">${{ google_revenue|default:0|floatformat:2|intcomma }}</p>
                </td>
                <td class="p-3 text-center">
                    <p class="font-medium">${{ google_cpl|default:0|floatformat:2|intcomma }}</p>
                </td>
                <td class="p-3 text-center">
                    <p class="font-medium">${{ google_cpa|default:0|floatformat:2|intcomma }}</p>
                </td>
                <td class="p-3 text-center">
                    <p class="font-medium">${{ google_aov|default:0|floatformat:2|intcomma }}</p>
                </td>
                <td class="p-3 text-center">
                    <p class="font-medium">${{ google_roas|default:0|floatformat:2 }}</p>
                </td>
                <td class="p-3 text-center">
                    <p class="font-medium">{{ google_closing_percent|default:0|floatformat:2 }}%</p>
                </td>
            </tr>

            <!-- Facebook Row -->
            <tr class="hover:bg-gray-50 dark:hover:bg-gray-900/50">
                <td class="p-3 text-center">
                    <p class="font-medium">Facebook</p>
                </td>
                <td class="p-3 text-center">
                    <p class="font-medium">${{ facebook_ad_spend|default:0|floatformat:2|intcomma }}</p>
                </td>
                <td class="p-3 text-center">
                    <p class="font-medium">{{ facebook_count }}</p>
                </td>
                <td class="p-3 text-center">
                    <p class="font-medium">{{ facebook_event_count }}</p>
                </td>
                <td class="p-3 text-center">
                    <p class="font-medium">${{ facebook_revenue|default:0|floatformat:2|intcomma }}</p>
                </td>
                <td class="p-3 text-center">
                    <p class="font-medium">${{ facebook_cpl|default:0|floatformat:2|intcomma }}</p>
                </td>
                <td class="p-3 text-center">
                    <p class="font-medium">${{ facebook_cpa|default:0|floatformat:2|intcomma }}</p>
                </td>
                <td class="p-3 text-center">
                    <p class="font-medium">${{ facebook_aov|default:0|floatformat:2|intcomma }}</p>
                </td>
                <td class="p-3 text-center">
                    <p class="font-medium">${{ facebook_roas|default:0|floatformat:2 }}</p>
                </td>
                <td class="p-3 text-center">
                    <p class="font-medium">{{ facebook_closing_percent|default:0|floatformat:2 }}%</p>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<div class="mt-8 min-w-full overflow-x-auto rounded border border-gray-200 bg-white dark:border-gray-700 dark:bg-gray-800">
    <table class="min-w-full whitespace-nowrap align-middle text-sm">
        <thead>
            <tr>
                <th class="bg-gray-100/75 px-3 py-4 text-left font-semibold text-gray-900 dark:bg-gray-700/25 dark:text-gray-50">
                    Segment
                </th>
                <th class="bg-gray-100/75 px-3 py-4 text-center font-semibold text-gray-900 dark:bg-gray-700/25 dark:text-gray-50">
                    Events
                </th>
                <th class="bg-gray-100/75 px-3 py-4 text-center font-semibold text-gray-900 dark:bg-gray-700/25 dark:text-gray-50">
                    Total Revenue
                </th>
                <th class="bg-gray-100/75 px-3 py-4 text-center font-semibold text-gray-900 dark:bg-gray-700/25 dark:text-gray-50">
                    Avg Event Value
                </th>
            </tr>
        </thead>
        <tbody>
            <!-- Bartending -->
            <tr class="hover:bg-gray-50 dark:hover:bg-gray-900/50">
                <td class="p-3 font-medium">Bartending</td>
                <td class="p-3 text-center">
                    {{ bartending_event_count|default:0 }}
                </td>
                <td class="p-3 text-center">
                    ${{ bartending_revenue|default:0|floatformat:2|intcomma }}
                </td>
                <td class="p-3 text-center">
                    ${{ bartending_aov|default:0|floatformat:2|intcomma }}
                </td>
            </tr>

            <!-- Rentals -->
            <tr class="hover:bg-gray-50 dark:hover:bg-gray-900/50">
                <td class="p-3 font-medium">Rentals</td>
                <td class="p-3 text-center">
                    {{ rental_event_count|default:0 }}
                </td>
                <td class="p-3 text-center">
                    ${{ rental_revenue|default:0|floatformat:2|intcomma }}
                </td>
                <td class="p-3 text-center">
                    ${{ rental_aov|default:0|floatformat:2|intcomma }}
                </td>
            </tr>
        </tbody>
    </table>
</div>
{% endblock %}