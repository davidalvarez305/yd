{% extends 'crm/base.html' %}
{% load static %}
{% load humanize %}

{% block content %}
<form method="get" class="flex flex-wrap items-end gap-4 mb-8">
  <div class="flex gap-2">
    {{ filter_form.render }}
  </div>
  <div>
    <button type="submit" class="inline-flex items-center justify-center gap-2 rounded-lg border border-primary-700 bg-primary-700 px-3 py-2 text-sm font-semibold text-white hover:border-primary-600 hover:bg-primary-600 focus:ring focus:ring-primary-400/50 active:border-primary-700 active:bg-primary-700 dark:focus:ring-primary-400/90">
      Filter
    </button>
  </div>
</form>

<div class="space-y-6">
  <div class="min-w-full overflow-x-auto rounded border border-gray-200 bg-white dark:border-gray-700 dark:bg-gray-800">
    <table class="min-w-full whitespace-nowrap align-middle text-sm">
      <thead>
        <tr>
          <th class="bg-gray-100/75 px-3 py-4 text-left font-semibold dark:bg-gray-700/25">
            Month
          </th>
          <th class="bg-gray-100/75 px-3 py-4 text-center font-semibold dark:bg-gray-700/25">
            Quotes
          </th>
          <th class="bg-gray-100/75 px-3 py-4 text-center font-semibold dark:bg-gray-700/25">
            Avg. Quote Value
          </th>
        </tr>
      </thead>
      <tbody>
        {% for row in metrics %}
          <tr class="hover:bg-gray-50 dark:hover:bg-gray-900/50">
            <td class="p-3 font-medium">
              {{ row.month|date:"F Y" }}
            </td>
            <td class="p-3 text-center">
              {{ row.count }}
            </td>
            <td class="p-3 text-center">
              ${{ row.avg_value|floatformat:2|intcomma }}
            </td>
          </tr>
        {% empty %}
          <tr>
            <td colspan="3" class="p-6 text-center text-gray-500">
              No prospecting data available for the selected filters.
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

</div>
{% endblock %}